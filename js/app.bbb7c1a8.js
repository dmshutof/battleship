(function(t){function e(e){for(var i,o,a=e[0],u=e[1],c=e[2],d=0,h=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(t[i]=u[i]);l&&l(e);while(h.length)h.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var u=n[a];0!==r[u]&&(i=!1)}i&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},s=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/battleship/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var l=u;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0e96":function(t,e,n){},4155:function(t,e,n){"use strict";n("0e96")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"bg",class:{dark:t.start_game}},[t.start_game?n("Battleground",{attrs:{name:t.name,"enemy-name":t.enemy_name}}):n("div",[n("h1",[t._v("Морской бой")]),1===t.step?n("div",{staticClass:"button",on:{click:function(e){t.step=2}}},[t._v("Играть")]):t._e(),2===t.step?n("form",{on:{submit:function(e){return e.preventDefault(),t.StartGame.apply(null,arguments)}}},[n("div",{staticClass:"input"},[n("label",{attrs:{for:"i1"}},[t._v("Ваше имя")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{id:"i1",type:"text",placeholder:"Введите ваше имя",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"input"},[n("label",{attrs:{for:"i2"}},[t._v("Имя противника")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.enemy_name,expression:"enemy_name"}],attrs:{id:"i2",type:"text",placeholder:"Введите имя противника",required:""},domProps:{value:t.enemy_name},on:{input:function(e){e.target.composing||(t.enemy_name=e.target.value)}}})]),n("button",{staticClass:"button",attrs:{type:"submit"}},[t._v("Начать игру")])]):t._e()])],1)])},s=[],o=(n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.userTurn?n("h2",[t._v("Ваш ход")]):n("h2",[t._v("Ход противника")]),n("div",{staticClass:"battleground"},[n("div",[n("div",{staticClass:"field_label"},[t._v(" Ваше поле("+t._s(t.name)+") ")]),n("GameField",{ref:"UserField",attrs:{"is-enemy":!1,"user-turn":t.userTurn},on:{"update:userTurn":function(e){t.userTurn=e},"update:user-turn":function(e){t.userTurn=e}}})],1),n("div",[n("div",{staticClass:"field_label"},[t._v(" Поле вашего противника("+t._s(t.enemyName)+") ")]),n("GameField",{attrs:{"is-enemy":!0,"user-turn":t.userTurn},on:{"update:userTurn":function(e){t.userTurn=e},"update:user-turn":function(e){t.userTurn=e}}})],1)])])}),a=[],u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("transition",{attrs:{name:"fade"}},[t.shipCount?t._e():i("div",{staticClass:"game_result"},["USER"===t.winGame?i("h2",[t._v("Вы победили")]):t._e(),"PC"===t.winGame?i("h2",[t._v("Вы проиграли")]):t._e(),i("button",{staticClass:"button",on:{click:t.reset}},[t._v("начать заного")])])]),i("div",{staticClass:"field",class:{disabled:!t.shipCount,enemy_field:t.isEnemy}},t._l(t.gridItems,(function(e,r){return i("div",{key:r,staticClass:"field__cell",class:{ship:e.ship,hit:e.hit,dead:e.dead,miss:e.miss},on:{click:function(n){t.isEnemy&&t.userFire(e)}}},[e.miss?i("span",{staticClass:"miss"},[t._v("· "),e.miss?i("img",{staticStyle:{width:"30px",height:"37px"},attrs:{src:n("5e13"),alt:""}}):t._e()]):t._e(),e.explosion&&!e.dead?i("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:n("62b3"),alt:""}}):t._e(),e.dead?i("img",{staticStyle:{width:"30px",height:"37px"},attrs:{src:n("a173"),alt:""}}):t._e(),i("small",{staticStyle:{position:"absolute","font-size":"8px",left:"1px",bottom:"1px"}},[t._v(t._s(e.coords))])])})),0)],1)},c=[],l=n("b85c"),d=(n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),n("7db0"),n("159b"),{name:"GameField",props:{isEnemy:Boolean,userTurn:Boolean},data:function(){return{gridItems:[],shipCount:0,winGame:"",optionShip:{count:[1,2,3,4],size:[4,3,2,1]},ships:[],collision:new Set,enemyLastLuckyHit:null}},mounted:function(){this.createGrid()},methods:{userFire:function(t){var e=this;if(!this.shipCount&&this.userTurn)return!1;if(!1===t.hit){t.miss=!0,this.$emit("update:userTurn",!1);for(var n=0;n<this.ships.length;n++){var i=this.ships[n],r=i.location.indexOf(t.coords);if(r>=0){i.hit[r]="x",t.hit=!0,t.miss=!1,t.explosion=!0,setTimeout((function(){t.explosion=!1}),700);var s=i.hit.indexOf("");this.$emit("update:userTurn",!0),s<0&&function(){var t,n=[],r=Object(l["a"])(i.location);try{var s=function(){var i=t.value;console.log(i),e.gridItems.forEach((function(t){if(t.coords===i){t.dead=!0;var e={x:parseInt(i[0]),y:parseInt(i[1])};n.push(e.x-1+""+e.y,e.x+1+""+e.y,e.x+""+(e.y-1),e.x+""+(e.y+1),e.x-1+""+(e.y-1),e.x-1+""+(e.y+1),e.x+1+""+(e.y+1),e.x+1+""+(e.y-1))}}))};for(r.s();!(t=r.n()).done;)s()}catch(c){r.e(c)}finally{r.f()}for(var o=function(){var t=u[a],n=e.gridItems.find((function(e){return e.coords===t}));n&&!n.dead&&(n.miss=!0)},a=0,u=n;a<u.length;a++)o();e.shipCount-=1,e.shipCount||(e.winGame="USER")}()}}setTimeout((function(){!1===e.userTurn&&e.enemyFire()}),500)}},enemyFire:function(t){var e=this,n=this.$parent.$refs.UserField;if(!n.shipCount&&!n.userTurn)return!1;var i=t||n.gridItems[n.enemyLastLuckyHit?this.getCell(n,i):Math.floor(100*Math.random())];if(console.log(t,i.coords),i.hit)n.enemyLastLuckyHit?(console.log("userField.enemyLastLuckyHit"),this.enemyFire(n.gridItems[this.getCell(n,i)])):this.enemyFire();else{i.miss=!0,this.$emit("update:userTurn",!0);for(var r=0;r<n.ships.length;r++){var s=n.ships[r],o=s.location.indexOf(i.coords);if(o>=0){s.hit[o]="x",i.hit=!0,i.miss=!1,i.explosion=!0,n.enemyLastLuckyHit=i.coords,setTimeout((function(){i.explosion=!1}),700);var a=s.hit.indexOf("");this.$emit("update:userTurn",!1),setTimeout((function(){e.enemyFire(n.gridItems[e.getCell(n,i)])}),500),a<0&&function(){var t,i=[],r=Object(l["a"])(s.location);try{var o=function(){var e=t.value;n.gridItems.forEach((function(t){if(t.coords===e){t.dead=!0,n.enemyLastLuckyHit=null;var r={x:parseInt(e[0]),y:parseInt(e[1])};i.push(r.x-1+""+r.y,r.x+1+""+r.y,r.x+""+(r.y-1),r.x+""+(r.y+1),r.x-1+""+(r.y-1),r.x-1+""+(r.y+1),r.x+1+""+(r.y+1),r.x+1+""+(r.y-1))}}))};for(r.s();!(t=r.n()).done;)o()}catch(d){r.e(d)}finally{r.f()}for(var a=function(){var t=c[u],e=n.gridItems.find((function(e){return e.coords===t}));e&&!e.dead&&(e.miss=!0)},u=0,c=i;u<c.length;u++)a();n.shipCount-=1,n.shipCount||(e.winGame="PC")}()}}}},getCell:function(t,e){var n=t.enemyLastLuckyHit||e.coords,i=t.gridItems.find((function(t){return t.coords===n})),r=[];r.push(i.x-1+""+i.y,i.x+1+""+i.y,i.x+""+(i.y-1),i.x+""+(i.y+1));for(var s=[],o=function(){var e=u[a],n=t.gridItems.find((function(t){return t.coords===e&&!t.hit&&!t.miss}));console.log("item",n),n&&s.push(e)},a=0,u=r;a<u.length;a++)o();return console.log(s),s[Math.floor(Math.random()*s.length)]},createGrid:function(){for(var t=0,e=0;e<10;e++)for(var n=0;n<10;n++)this.gridItems.push({x:e,y:n,coords:e+""+n,index:t,miss:!1,hit:!1,dead:!1,ship:!1,explosion:!1}),t++;this.generateShip()},generateShip:function(){for(var t=this,e=0;e<this.optionShip.count.length;e++)for(var n=0;n<this.optionShip.count[e];n++){var i=this.optionShip.size[e],r=this.generateOptionsShip(i);this.ships.push(r),this.shipCount++}this.ships.forEach((function(e){t.gridItems.forEach((function(t){e.location.forEach((function(e){t.coords===e&&(t.ship=!0)}))}))}))},generateOptionsShip:function(t){var e,n,i={hit:[],location:[]},r=Math.random()<.5;r?(e=Math.floor(10*Math.random()),n=Math.floor(Math.random()*(10-t))):(e=Math.floor(Math.random()*(10-t)),n=Math.floor(10*Math.random()));for(var s=0;s<t;s++)r?i.location.push(e+""+(n+s)):i.location.push(e+s+""+n),i.hit.push("");return this.checkCollision(i.location)?this.generateOptionsShip(t):(this.addColission(i.location),i)},checkCollision:function(t){var e,n=Object(l["a"])(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(this.collision.has(i))return!0}}catch(r){n.e(r)}finally{n.f()}},addColission:function(t){for(var e=0;e<t.length;e++)for(var n=t[e][0]-1,i=n;i<n+3;i++)for(var r=t[e][1]-1,s=r;s<r+3;s++)if(i>=0&&i<10&&s>=0&&s<10){var o=i+""+s;this.collision.add(o)}},reset:function(){this.ships=[],this.gridItems=[],this.winGame="",this.collision=new Set,this.userTurn=!0,this.shipCount=0,this.createGrid();var t=this.$parent.$children.find((function(t){return 3===t._uid}));t.ships=[],t.gridItems=[],t.winGame="",t.collision=new Set,t.userTurn=!0,t.shipCount=0,t.createGrid()}}}),h=d,f=(n("4155"),n("2877")),p=Object(f["a"])(h,u,c,!1,null,"c2e2b31e",null),m=p.exports,v={name:"Battleground",props:["name","enemyName"],components:{GameField:m},data:function(){return{userTurn:!0}}},y=v,g=(n("63c7"),Object(f["a"])(y,o,a,!1,null,"1a70c156",null)),x=g.exports,_={name:"App",components:{Battleground:x},data:function(){return{name:"",enemy_name:"",start_game:!1,step:1}},methods:{StartGame:function(){this.name&&this.enemy_name&&(this.start_game=!0)}}},b=_,C=(n("5c0b"),Object(f["a"])(b,r,s,!1,null,null,null)),w=C.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(w)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";n("9c0c")},"5e13":function(t,e,n){t.exports=n.p+"img/water.abcd6866.gif"},"62b3":function(t,e,n){t.exports=n.p+"img/VJeo.729bac3f.gif"},"63c7":function(t,e,n){"use strict";n("a464")},"9c0c":function(t,e,n){},a173:function(t,e,n){t.exports=n.p+"img/fire.8992cd6c.gif"},a464:function(t,e,n){}});
//# sourceMappingURL=app.bbb7c1a8.js.map